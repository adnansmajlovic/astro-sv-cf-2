---
import BaseLayout from "../layouts/BaseLayout.astro";

// Prefer locals (your middleware already sets these)
const auth = Astro.locals.auth;
const session = Astro.locals.session;
const user = Astro.locals.user;

// If no session, redirect to home
if (!session) {
    return Astro.redirect("/");
}
---

<BaseLayout title="Welcome - Adi Q">
    <main
        class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 py-12 px-4 sm:px-6 lg:px-8"
    >
        <div class="max-w-4xl mx-auto">
            <!-- Welcome Header -->
            <div class="text-center mb-12">
                <div
                    class="mx-auto h-16 w-16 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center mb-6"
                >
                    <svg
                        class="h-8 w-8 text-green-600 dark:text-green-400"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M5 13l4 4L19 7"></path>
                    </svg>
                </div>

                <h1
                    class="text-4xl font-extrabold text-gray-900 dark:text-white mb-4"
                >
                    Welcome to Adi Q!
                </h1>

                <p class="text-xl text-gray-600 dark:text-gray-300 mb-2">
                    Hi {user?.name || user?.email || "User"}! Your account has
                    been successfully created.
                </p>

                <p class="text-sm text-gray-500 dark:text-gray-400">
                    You're now ready to explore all the features we have to
                    offer.
                </p>
            </div>

            <!-- User Profile Card -->
            <div
                class="bg-white dark:bg-gray-800 shadow-xl rounded-lg p-8 mb-8"
            >
                <div class="flex items-center space-x-6">
                    {
                        user?.image ? (
                            <img
                                src={user.image}
                                alt="Profile"
                                class="h-20 w-20 rounded-full ring-4 ring-blue-500 ring-opacity-20"
                                referrerpolicy="no-referrer"
                            />
                        ) : (
                            <div class="h-20 w-20 rounded-full bg-gray-400 dark:bg-gray-600 flex items-center justify-center ring-4 ring-blue-500 ring-opacity-20">
                                <svg
                                    class="w-10 h-10 text-white"
                                    fill="currentColor"
                                    viewBox="0 0 24 24"
                                >
                                    <path d="M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z" />
                                </svg>
                            </div>
                        )
                    }

                    <div>
                        <h2
                            class="text-2xl font-bold text-gray-900 dark:text-white"
                        >
                            {user?.name || "Welcome!"}
                        </h2>
                        <p class="text-gray-600 dark:text-gray-300 mb-1">
                            {user?.email || "No email provided"}
                        </p>
                        <span
                            class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300"
                        >
                            New Member
                        </span>
                    </div>
                </div>
            </div>

            <!-- ... keep the rest of your sections unchanged ... -->

            <div class="mt-6">
                <a
                    href="/"
                    class="bg-white text-blue-600 px-6 py-2 rounded-lg font-medium hover:bg-blue-50 transition-colors"
                >
                    Continue to Dashboard
                </a>
            </div>
        </div>
    </main>
</BaseLayout>

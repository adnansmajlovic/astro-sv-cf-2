---
export const prerender = false;

import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("blog"))
    .filter((p) => !p.data.draft)
    .sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime());

function fmt(d: Date) {
    return d.toLocaleDateString("en-CA"); // YYYY-MM-DD
}
---

<BaseLayout
    title="Blog"
    description="Writing and notes on building, talent, and startups."
>
    <main class="mx-auto w-full max-w-3xl px-4 py-10 sm:px-6">
        <header class="mb-8">
            <h1 class="text-3xl font-semibold tracking-tight sm:text-4xl">
                Blog
            </h1>
            <p class="mt-2 text-lg text-slate-300">
                Writing and notes on building, talent, and startups.
            </p>
        </header>

        <ul class="m-0 list-none p-0">
            {
                posts.map((post) => (
                    <li class="border-b border-slate-800 last:border-b-0">
                        <a
                            href={`/blog/${post.slug}/`}
                            class="flex items-baseline gap-4 py-2
                   hover:bg-slate-900/40
                   rounded-lg px-2 -mx-2
                   transition"
                        >
                            <time class="w-28 shrink-0 text-sm text-slate-400 tabular-nums">
                                {fmt(post.data.pubDate)}
                            </time>

                            <span class="text-base sm:text-lg font-medium text-slate-100">
                                {post.data.title}
                            </span>
                        </a>
                    </li>
                ))
            }
        </ul>
    </main>
</BaseLayout>

<style>
    .mf-wrap {
        max-width: 70ch;
        margin: 0 auto;
        padding: 2rem 1.25rem 3rem;
    }

    .mf-list {
        list-style: none;
        margin: 0;
        padding: 0;
        border-top: 1px solid rgba(148, 163, 184, 0.25);
    }

    .mf-item {
        padding: 0.85rem 0;
        border-bottom: 1px solid rgba(148, 163, 184, 0.2);
    }

    .mf-title {
        font-size: 1.05rem;
        line-height: 1.25;
        text-decoration: underline;
        text-underline-offset: 0.14em;
    }

    .mf-desc {
        margin-top: 0.35rem;
        opacity: 0.9;
    }

    .mf-meta {
        margin-top: 0.35rem;
        font-size: 0.9rem;
        opacity: 0.75;
    }
</style>
